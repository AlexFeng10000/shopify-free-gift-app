<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>App Bridge Test</title>
    <script src="https://unpkg.com/@shopify/app-bridge@3"></script>
</head>
<body>
    <h1>App Bridge Test Page</h1>
    <div id="status"></div>
    
    <script>
        const statusDiv = document.getElementById('status');
        
        function updateStatus(message) {
            statusDiv.innerHTML += '<p>' + message + '</p>';
            console.log(message);
        }
        
        // Test App Bridge availability
        updateStatus('Testing App Bridge availability...');
        
        if (typeof window.ShopifyAppBridge !== 'undefined') {
            updateStatus('✅ App Bridge is available');
            
            // Try to initialize App Bridge
            try {
                const app = window.ShopifyAppBridge.createApp({
                    apiKey: '0a84e1df4c003abfab2f61d8344ea04b',
                    host: 'test-host',
                    forceRedirect: false
                });
                
                updateStatus('✅ App Bridge initialized successfully');
                
                // Test authenticated fetch
                const authenticatedFetch = window.ShopifyAppBridge.authenticatedFetch(app);
                updateStatus('✅ Authenticated fetch available: ' + typeof authenticatedFetch);
                
            } catch (error) {
                updateStatus('❌ App Bridge initialization failed: ' + error.message);
            }
        } else {
            updateStatus('❌ App Bridge is not available');
        }
        
        // Test URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        updateStatus('URL Parameters:');
        updateStatus('- shop: ' + (urlParams.get('shop') || 'not provided'));
        updateStatus('- host: ' + (urlParams.get('host') || 'not provided'));
        updateStatus('- hmac: ' + (urlParams.get('hmac') || 'not provided'));
    </script>
</body>
</html>